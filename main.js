(()=>{var e={952:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n="object"==("undefined"==typeof document?"undefined":t(document))&&document.all,o=void 0===n&&void 0!==n;e.exports={all:n,IS_HTMLDDA:o}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(()=>{"use strict";var e=document.getElementById("modal-post"),t=document.getElementById("modal-image"),o=(document.getElementById("textareaName"),document.getElementById("textareaDescription"),document.getElementById("modal-profile")),r=document.getElementById("modalAvatar"),a=document.getElementById("description"),c=document.getElementById("name"),i=document.getElementById("avatar"),d=document.querySelector(".modal__image"),l=document.querySelector(".modal__text"),u=document.getElementById("edit-btn"),s=document.getElementById("editAvatarButton"),m=document.getElementById("modal-close-btn"),f=document.getElementById("add-btn"),v=document.getElementById("modal-save-btn"),p=document.getElementById("modal-save-btn-post"),y=document.getElementById("modal-save-btn-avatar"),h=document.getElementById("modal-close-btn-post"),b=document.getElementById("modal-close-btn-avatar"),g=(document.getElementById("textareaNamePost"),document.getElementById("textareaSrcPost"),document.querySelector(".modal__name"),document.querySelector(".modal__description"),document.querySelector(".gallery__wrapper")),_=document.querySelectorAll(".popup"),E=function(e){e.classList.add("popup__open"),document.addEventListener("keydown",L)},S=function(e){e.classList.remove("popup__open"),document.removeEventListener("keydown",L)},L=function e(t){if("Escape"===t.key){var n=document.querySelector(".popup__open");S(n),document.removeEventListener("keydown",e)}};_.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup__open")&&e.classList.toggle("popup__open")}))}));var C=document.forms.profileForm,x=C.elements.nameProfile,I=C.elements.descriptionProfile,k=document.forms.contentForm,B=k.elements.namePost,A=k.elements.srcPost,q=document.forms.avatarForm,w=q.elements.srcAvatar;function j(e){e?(v.removeAttribute("disabled"),v.classList.remove("modal__save-btn_disabled")):(v.setAttribute("disabled",!0),v.classList.add("modal__save-btn_disabled"))}function T(e){e?(p.removeAttribute("disabled"),p.classList.remove("modal__save-btn_disabled")):(p.setAttribute("disabled",!0),p.classList.add("modal__save-btn_disabled"))}function P(e){e?(y.removeAttribute("disabled"),y.classList.remove("modal__save-btn_disabled")):(y.setAttribute("disabled",!0),y.classList.add("modal__save-btn_disabled"))}C.addEventListener("input",(function(e){j(x.value.length>=2&&I.value.length>=2)})),k.addEventListener("input",(function(e){T(B.value.length>=2&&A.validity.valid)})),q.addEventListener("input",(function(e){P(w.validity.valid)}));var O,D={baseUrl:"https://nomoreparties.co/v1/wbf-cohort-9",headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"}},N=function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))};function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}n(952);var J,F=function(e){e.preventDefault()};function U(e,t){var n=document.getElementById("card-template").content.querySelector(".gallery__item").cloneNode(!0),o=n.querySelector(".gallery__likeCounter"),r=n.querySelector(".gallery__image"),a=e.likes,c=n.querySelector(".gallery__delete-button");n.querySelector(".gallery__image-button").addEventListener("click",M);var i=n.querySelector(".gallery__like-button");function d(e){return e.some((function(e){return e._id===t}))}function l(e){a=e,i.classList.toggle("gallery__like-button_active",d(e)),o.textContent=e.length}e.owner._id===t?c.addEventListener("click",(function(){var t;(t=e._id,fetch("https://nomoreparties.co/v1/wbf-cohort-9/cards/".concat(t),{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"DELETE",body:JSON.stringify({})}).then(N)).then((function(){n.remove()})).catch((function(e){return console.log(e)}))})):c.remove(),r.src=e.link,r.alt=e.name,n.querySelector(".gallery__title").textContent=e.name;return i.addEventListener("click",(function(){return t=d(a)?function(e){return fetch("https://nomoreparties.co/v1/wbf-cohort-9/cards/likes/".concat(e._id),{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"DELETE",body:JSON.stringify({})}).then(N)}(e):function(e){return fetch("https://nomoreparties.co/v1/wbf-cohort-9/cards/likes/".concat(e._id),{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({})}).then(N)}(e),void t.then((function(e){l(e.likes)})).catch((function(e){console.log(e)}));var t})),l(a),n}document.forms.profileForm.addEventListener("submit",F),document.forms.contentForm.addEventListener("submit",F),J={formSelector:".form",inputSelector:".form__input"},document.querySelectorAll(J.formSelector).forEach((function(e){!function(e,t){e.querySelectorAll(t.inputSelector).forEach((function(t){t.addEventListener("input",(function(){return function(e,t){e.validity.valid?function(e,t){var n="".concat(e.id,"-error");t.querySelector("#".concat(n)).textContent=""}(e,t):function(e,t,n){var o="".concat(e.id,"-error");t.querySelector("#".concat(o)).textContent=n}(e,t,e.validationMessage)}(t,e)}))}))}(e,J)})),Promise.all([fetch("".concat(D.baseUrl,"/users/me"),{headers:D.headers}).then(N),fetch("https://nomoreparties.co/v1/wbf-cohort-9/cards",{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"}}).then(N)]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,c,i=[],d=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;d=!1}else for(;!(d=(o=a.call(n)).done)&&(i.push(o.value),i.length!==t);d=!0);}catch(e){l=!0,r=e}finally{try{if(!d&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw r}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],d=o[1];O=r._id,c.textContent=r.name,a.textContent=r.about,i.src=r.avatar,d.reverse().forEach((function(e){H(e)}))})).catch((function(e){console.log(e)}));var H=function(e){g.prepend(U(e,O))};function M(e){E(t);var n=e.target.src,o=e.target.alt;d.src=n,l.textContent=o,l.alt=o}k.addEventListener("submit",(function(t){var n,o;t.preventDefault(),p.textContent="Создание...",(n=B.value,o=A.value,fetch("https://nomoreparties.co/v1/wbf-cohort-9/cards",{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:n,link:o})}).then(N)).then((function(e){H(e)})).catch((function(e){console.log(e)})).finally((function(){p.textContent="Создать",t.target.reset()})),k.reset(),S(e),T(!1)})),C.addEventListener("submit",(function(e){e.preventDefault(),v.textContent="Сохранение...",(x.value,I.value,fetch("https://nomoreparties.co/v1/wbf-cohort-9/users/me",{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"PATCH",body:JSON.stringify({name:x.value,about:I.value})}).then(N)).then((function(e){c.textContent=e.name,a.textContent=e.about,S(o),C.reset(),j(!1)})).catch((function(e){console.log(e)})).finally((function(){v.textContent="Сохранить"}))})),q.addEventListener("submit",(function(e){e.preventDefault(),y.textContent="Сохранение...",function(e){return fetch("https://nomoreparties.co/v1/wbf-cohort-9/users/me/avatar",{headers:{authorization:"2cdae549-d4cc-4251-8eef-46d5577a6d11","Content-Type":"application/json"},method:"PATCH",body:JSON.stringify({avatar:e})}).then(N)}(w.value).then((function(e){i.src=e.avatar,q.reset(),S(r),P(!1)})).catch((function(e){console.log(e)})).finally((function(){y.textContent="Сохранить"}))})),document.getElementById("modal-close-btn-image").addEventListener("click",(function(){S(t)})),u.addEventListener("click",(function(){E(o),x.textContent=c.textContent,I.textContent=a.textContent})),f.addEventListener("click",(function(){E(e)})),s.addEventListener("click",(function(){E(r)})),m.addEventListener("click",(function(){S(o)})),h.addEventListener("click",(function(){S(e)})),b.addEventListener("click",(function(){S(r)}))})()})();